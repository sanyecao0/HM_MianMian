## 一、项目介绍

### 1、项目介绍

《黑马面面》是一套收纳了众多面试题的后台管理系统，通过这套管理系统，面试者可以进行刷题，提高求职成功率。这个项目提供了企业管理、部门管理、用户管理、题目管理等模块，同时涉及到权限系统的涉及。通过这个小项目的练习，能够让大家对象项目开发的思路、细节有清晰的认识。

### 2、项目预览

2.1 、 进入后台管理系统必须要先进行用户登录

![image-20230601101326568](assets/image-20230601101326568.png)

2.2、 后台管理系统主界面

![image-20230601101415194](assets/image-20230601101415194.png)

![image-20230601101449671](assets/image-20230601101449671.png)

### 3、技术选型

![image-20230601101513620](assets/image-20230601101513620.png)

### 4、数据库设计

<img src="assets/image-20230601101613225.png" alt="image-20230601101613225" style="zoom: 50%;" />

<img src="assets/image-20230601101731330.png" alt="image-20230601101731330" style="zoom:50%;" />

## 二、环境搭建

### 1、数据库环境搭建

- idea关联MySQL数据库

<img src="assets/image-20230601113441728.png" alt="image-20230601113441728" style="zoom: 33%;" />

<img src="assets/image-20230601113503055.png" alt="image-20230601113503055" style="zoom:33%;" />

<img src="assets/image-20230601113536101.png" alt="image-20230601113536101" style="zoom:33%;" />

<img src="assets/image-20230601113604154.png" alt="image-20230601113604154" style="zoom:33%;" />

> 也有同学可能有如下错误：
>
> <img src="assets/image-20230601113630486.png" alt="image-20230601113630486" style="zoom:33%;" />
>
> 那是因为MySQL服务没开，在windows中搜索“服务”，然后开启MySQl服务即可
>
> <img src="assets/image-20230601113720584.png" alt="image-20230601113720584" style="zoom:33%;" />

- 运行“资料/1.数据库文件”中的`heima_mm.sql`文件，创建数据库和表，初始化表中的数据

### 2、项目环境搭建

- 将 "==资料/2.初始化项目==" 中给的**==heima_mm==**初始化项目复制到“==代码==”文件夹中，然后使用idea创建项目，选择代码文件中的heima_mm就行了。

<img src="assets/image-20230601110352466.png" alt="image-20230601110352466" style="zoom: 33%;" />

<img src="assets/image-20230601110445427.png" alt="image-20230601110445427" style="zoom: 33%;" />

> 点击完“Configure”之后，web目录上如果没有蓝色的小点点，就file-->close project，然后重新打卡此项目就行了

- 给当前项目设置jdk（file-->project structure-->prject）

<img src="assets/image-20230601110737406.png" alt="image-20230601110737406" style="zoom: 33%;" />

- 给当前项目打war包（file-->project structure-->Artifacts）

<img src="assets/image-20230601111037565.png" alt="image-20230601111037565" style="zoom:50%;" />

- 集成本地tomcat，部署项目

<img src="assets/image-20230601111923545.png" alt="image-20230601111923545" style="zoom: 33%;" />

> 注意：在部署项目的时候，大家可以改一下项目的虚拟目录：<img src="assets/image-20230601112644756.png" alt="image-20230601112644756" style="zoom: 50%;" />

- 给项目添加tomcat环境（file-->project structure-->modules）以及将“WEB-INF/lib”目录中的jar包“add as library”

<img src="assets/image-20230601112433190.png" alt="image-20230601112433190" style="zoom: 50%;" />

> 至此，我们的初始化项目就搭建完成了，启动tomcat，访问我们的首页面即可：http://localhost:8080/heima_mm
>
> <img src="assets/image-20230601112758975.png" alt="image-20230601112758975" style="zoom:50%;" />

## 三、企业管理

### 1、需求分析

![image-20230601144003655](assets/image-20230601144003655.png)

​		启动服务器之后，点击==登录==（此功能未开发，直接跳转到后端页面）。点击“==平台系统管理-->企业管理==”，首先需要==分页查询==所有企业信息，其次点击“==新建==”会弹出对话框，添加企业信息。点击每个条目后面的“==编辑==”按钮弹出对话框，会==根据id查询企业信息==显示在对话框中，用户可以针对企业信息进行修改，修改完成之后点击对话框中的“==保存”完成修改==操作。最后就是点击条目后面的“==删除==”按钮，可以根据id删除一个企业信息。

对应的表结构如下：

<img src="assets/image-20230602113802945.png" alt="image-20230602113802945" style="zoom:50%;" />

### 2、分页查询

![image-20230601145636712](assets/image-20230601145636712.png)

#### 2.1 前端代码实现

- 点击侧边栏“==企业管理==”发送请求代码`pages/home/aside.jsp`【不用编写】

![image-20230601151505072](assets/image-20230601151505072.png)

- F12抓包请求信息

<img src="assets/image-20230601145950529.png" alt="image-20230601145950529" style="zoom:50%;" /><img src="assets/image-20230601150408624.png" alt="image-20230601150408624" style="zoom:50%;" />

<img src="assets/image-20230601150408624.png" alt="image-20230601145950529" style="zoom:50%;" />

- 前端页面处理结果`/WEB-INF/pages/system/company/list.jsp`和`/WEB-INF/pages/common/page.jsp`【不用编写】

<img src="assets/image-20230601151648457.png" alt="image-20230601151648457" style="zoom:50%;" />

> 解析：此处代码是`/WEB-INF/pages/system/company/list.jsp`页面遍历当前页数据展示到页面上。page表示存到域对象中的key，这个key对应的对象必须有list属性并且能够遍历，说明list属性对应的值是一个集合。

<img src="assets/image-20230601152137765.png" alt="image-20230601152137765" style="zoom:50%;" />

> 此处代码是`/WEB-INF/pages/common/page.jsp`中处理分页条的代码，通过以上代码可以知道域对象中page对应的对象身上还有pages、total、prePage、navigateFirstPage、navigateLastPage、currPage、nextPage等属性
>
> 综上所述：域对象中page对应的对象必须有：list、pages、total、prePage、navigateFirstPage、navigateLastPage、currPage、nextPage这些属性。于是在后端定义了一个PageBean类来封装这些数据：
>
> <img src="assets/image-20230601152540543.png" alt="image-20230601152540543" style="zoom:50%;" />

#### 2.2 后端代码实现

![image-20230601151252197](assets/image-20230601151252197.png)

##### 2.2.1 控制层

- CompanyServlet类

说明：我们发现请求中有一组参数为`operation=list`，这是因为我们想使用一个Servlet来处理企业相关的所有请求，这组参数就是用来区分到底是什么操作的请求。例如：分页查询是`operation=list`，新增时`operation=toAdd和operation=save`，修改是`operation=toEdit和operation=edit`，删除是`operation=delete`。于是我们可以进行如下判断：

```java
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    //1 获取请求标记
    String operation = request.getParameter("operation");
    //2 判断标记，调用不同的方法处理请求
    try {
        if("list".equals(operation)){
            //调用分页查询的方法
            list(request,response);
        }else if("toAdd".equals(operation)){
            //调用跳转到添加页面的方法
            toAdd(request,response);
        }else if("save".equals(operation)){
            //调用添加数据的方法
            save(request,response);
        }else if("toEdit".equals(operation)){
            //调用跳转到修改页面的方法
            toEdit(request,response);
        }else if("edit".equals(operation)){
            //调用修改数据的方法
            edit(request,response);
        }else if("delete".equals(operation)){
            //调用删除数据的方法
            delete(request,response);
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
}
```

```java
/**
     * 处理分页查询的请求
     * @param request
     * @param response
     */
private void list(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数（当前页数和每页条数）
    String _currPage = request.getParameter("currPage");
    //判断非空
    int currPage=1,pageSize=5; //定义默认的页码和每页条数
    if(!StringUtils.isBlank(_currPage)){
        currPage=Integer.parseInt(_currPage);
    }
    //2 调用service层方法获取分页结果
    PageBean<Company> pageBean = companyService.findPage(currPage, pageSize);

    //3 将结果存储到request域中，跳转到/WEB-INF/pages/system/company/list.jsp页面
    request.setAttribute("page",pageBean);
    request.getRequestDispatcher("/WEB-INF/pages/system/company/list.jsp").forward(request,response);
}
```

##### 2.2.2 业务层

- CompanyService接口

```java
/**
     * 分页查询查询信息
     * @return
     */
PageBean<Company> findPage(int currPage, int pageSize) throws SQLException;
```

- CompanyServiceImpl实现类

```java
/**
* 分页查询查询信息
* @return
*/
@Override
public PageBean<Company> findPage(int currPage, int pageSize) throws SQLException {
    //1 查询总记录数
    long total=companyDao.findTotal();
    //2 计算起始索引
    int start=(currPage-1)*pageSize;
    //3 查询当前页数据
    List<Company> list=companyDao.findPage(start,pageSize);
    //4 封装分页结果并返回
    return new PageBean<>(currPage,pageSize,total,list);
}
```

##### 2.2.3 数据访问层

- CompanyDao接口

```java
/**
     * 查询总记录数
     * @return
     */
long findTotal() throws SQLException;
/**
     * 查询当前页数据
     * @param start 当前页起始索引
     * @param pageSize 每页条数
     * @return 当前页数据
     */
List<Company> findPage(int start, int pageSize) throws SQLException;
```

- CompanyDaoImpl实现类

```java
/**
     * 查询总记录数
     * @return
     */
@Override
public long findTotal() throws SQLException {
    return queryRunner.query("select count(*) from company",new ScalarHandler<>());
}

/**
* 查询当前页数据
* @param start 当前页起始索引
* @param pageSize 每页条数
* @return 当前页数据
*/
@Override
public List<Company> findPage(int start, int pageSize) throws SQLException {
    return queryRunner.query("select * from company order by updateTime desc limit ?,?",new BeanListHandler<>(Company.class),start,pageSize);
}
```

### 3、新增企业

<img src="assets/image-20230601162918671.png" alt="image-20230601162918671" style="zoom:50%;" />

点击“新建”按钮，跳转到新增企业的页面`/WEB-INF/pages/system/company/add.jsp`,用户填写完企业信息之后点击“==保存==”按钮，保存企业信息。

![image-20230601154210033](assets/image-20230601154210033.png)

> 由于新增企业的页面在WEB-INF目录中，浏览器是无法直接访问的，必须在后端Servlet转发访问。

#### 3.1 跳转到新增页面

##### 3.1.1 前端代码实现

- `/WEB-INF/pages/system/company/list.jsp`页面代码【不用编写】

<img src="assets/image-20230601154739397.png" alt="image-20230601154739397" style="zoom: 50%;" />

- F12抓包数据

<img src="assets/image-20230601154919555.png" alt="image-20230601154919555" style="zoom:50%;" />

##### 3.1.2 后端代码实现

<img src="assets/image-20230602084816246.png" alt="image-20230602084816246" style="zoom:50%;" />

###### 3.1.2.1 控制层

- CompanyServlet类

```java
/**
     * 处理跳转到添加页面的请求
     * @param request
     * @param response
     */
private void toAdd(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    //只能使用请求转发，因为页面是在web-inf中，浏览器不能直接通过路径访问
    request.getRequestDispatcher("/WEB-INF/pages/system/company/add.jsp").forward(request,response);
}
```

#### 3.2 保存企业信息



##### 3.2.1 前端代码实现

- `/WEB-INF/pages/system/company/add.jsp`页面代码【不用编写】

<img src="assets/image-20230601155046966.png" alt="image-20230601155046966" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230601155242202.png" alt="image-20230601155242202" style="zoom:50%;" />

##### 3.2.2 后端代码实现

![image-20230602090514916](assets/image-20230602090514916.png)

###### 3.2.2.1 控制层

- CompanyServlet类

```java
/**
     * 处理添加数据的请求
     * @param request
     * @param response
     */
private void save(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数并封装成Company对象
    Company company = BeanUtil.fillBean(request, Company.class);
    //2 调用service层方法添加数据
    companyService.save(company);
    //3 页面跳转
    list(request,response);
}
```

###### 3.2.2.2 业务层

- CompanyService接口

```java
/**
     * 保存信息
     * @param company
     */
void save(Company company) throws SQLException;
```

- CompanyServiceImpl实现类

```java
/**
     * 保存信息
     * @param company
     */
@Override
public void save(Company company) throws SQLException {
    //1 生成唯一id，设置给company
    String id = UUID.randomUUID().toString();
    company.setId(id);
    //2 调用dao层方法
    companyDao.save(company);
}
```

###### 3.2.2.3 数据访问层

- CompanyDao接口

```java
/**
     * 添加数据
     * @param company 要添加的对象
     */
void save(Company company) throws SQLException;
```

- CompanyDaoImpl实现类

```java
/**
     * 添加数据
     * @param company 要添加的对象
     */
@Override
public void save(Company company) throws SQLException {
    queryRunner.update("insert into company values(?,?,?,?,?,?,?,?,?,?,?,?,now(),now())",company.getId(),company.getName(),company.getExpirationDate(),company.getAddress(),company.getLicenseId(),company.getRepresentative(),company.getPhone(),company.getCompanySize(),company.getIndustry(),company.getRemarks(),company.getState(),company.getCity());
}
```

###### 3.2.2.4 BeanUtil工具类【不用编写】

```java
/**
	 * 封装表单中的数据到javabean中
	 * @param request	表单中的数据
	 * @param clazz		封装到哪个javabean
	 * @return	封装好的javabean对象
	 * 使用的是泛型。泛型必须先声明再使用。声明必须在返回值之前
	 * T指的就是泛型，它可以是任意字符，只是作为一个占位符。
	 * 声明时用什么字符，使用时就得用什么
	 */
public static <T> T fillBean(HttpServletRequest request,Class<T> clazz){
    //1.定义一个T类型的javabean
    T bean = null;
    try{
        //2.实例化bean对象
        bean = clazz.newInstance();
        //3.使用BeanUtils的方法进行封装
        BeanUtils.populate(bean, request.getParameterMap());
        //4.返回
        return bean;
    }catch(Exception e){
        throw new RuntimeException(e);
    }
}
```

### 4、编辑企业

<img src="assets/image-20230601163016559.png" alt="image-20230601163016559" style="zoom:50%;" />

#### 4.1 回显企业

点击每个条目后面的“==编辑==”按钮，最终会跳转到编辑页面显示原始的企业信息，其本质就是根据id查询企业。

![image-20230601161125345](assets/image-20230601161125345.png)

##### 4.1.1 前端代码实现

- `/WEB-INF/pages/system/company/list.jsp`页面代码【不用编写】

<img src="assets/image-20230601161355858.png" alt="image-20230601161355858" style="zoom:50%;" />

- F12抓数据包

<img src="assets/image-20230601161428637.png" alt="image-20230601161428637" style="zoom:50%;" />

##### 4.1.2 后端代码实现

<img src="assets/image-20230602085403167.png" alt="image-20230602085403167" style="zoom:50%;" />

###### 4.1.2.1 控制层

- CompanyServlet类

```java
/**
     * 处理跳转到修改页面的氢气
     * @param request
     * @param response
     */
private void toEdit(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取要修改的数据id
    String id = request.getParameter("id");
    // 2 调用service层方法，根据id查询数据
    Company company = companyService.findById(id);
    //3 将结果保存到request域中，请求转发到update.jsp页面
    request.setAttribute("company",company);
    //只能使用请求转发，因为页面是在web-inf中，浏览器不能直接通过路径访问
    request.getRequestDispatcher("/WEB-INF/pages/system/company/update.jsp").forward(request,response);
}
```

###### 4.1.2.2 业务层

- CompanyService接口

```java
/**
   * 根据id查询信息
   * @param id 要查询的id
   * @return 返回对象
   */
Company findById(String id) throws SQLException;
```

- CompanyServiceImpl实现类

```java
/**
     * 根据id查询信息
     * @param id 要查询的id
     * @return 返回对象
     */
@Override
public Company findById(String id) throws SQLException {
    return companyDao.findById(id);
}
```

###### 4.1.2.3 数据访问层

- CompanyDao接口

```java
/**
     * 根据id查询数据
     * @param id 要查询数据的id
     * @return 返回的是查询结果的对象
     */
Company findById(String id) throws SQLException;
```

- CompanyDaoImpl实现类

```java
/**
     * 根据id查询数据
     * @param id 要查询数据的id
     * @return 返回的是查询结果的对象
     */
@Override
public Company findById(String id) throws SQLException {
    return queryRunner.query("select * from company where id=?",new BeanHandler<>(Company.class),id);
}
```

#### 4.2 修改企业

##### 4.2.1 前端代码实现

- `/WEB-INF/pages/system/company/update.jsp`页面代码【不用编写】

<img src="assets/image-20230601161748430.png" alt="image-20230601161748430" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230601162302386.png" alt="image-20230601162302386" style="zoom:50%;" />

##### 4.2.2 后端代码实现

<img src="assets/image-20230602090045978.png" alt="image-20230602090045978" style="zoom:50%;" />

###### 4.2.2.1 控制层

- CompanyServlet类

```java
/**
     * 处理修改数据的请求
     * @param request
     * @param response
     */
private void edit(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数并封装
    Company company = BeanUtil.fillBean(request, Company.class);
    //2 调用service层方法，修改数据
    companyService.update(company);
    //3 页面跳转
    list(request,response);
}
```

###### 4.2.2.2 业务层

- CompanyService接口

```java
/**
     * 修改信息
     * @param company
     */
void update(Company company) throws SQLException;
```

- CompanyServiceImpl实现类

```java
/**
     * 修改信息
     * @param company
     */
@Override
public void update(Company company) throws SQLException {
    companyDao.update(company);
}
```

###### 4.2.2.3 数据访问层

- CompanyDao接口

```java
/**
     * 修改数据
     * @param company 要修改的对象
     */
void update(Company company) throws SQLException;
```

- CompanyDaoImpl实现类

```java
/**
     * 修改数据
     * @param company 要修改的对象
     */
@Override
public void update(Company company) throws SQLException {
    queryRunner.update("update company set name=?,expirationDate=?,address=?,licenseId=?,representative=?,phone=?,companySize=?,industry=?,remarks=?,state=?,city=?,updateTime=now() where id=?",company.getName(),company.getExpirationDate(),company.getAddress(),company.getLicenseId(),company.getRepresentative(),company.getPhone(),company.getCompanySize(),company.getIndustry(),company.getRemarks(),company.getState(),company.getCity(),company.getId());
}
```

### 5、删除企业

![image-20230601163059678](assets/image-20230601163059678.png)

点击条目后面的“==删除==”按钮，可以删除这一条企业信息

#### 5.1 前端代码实现

- `/WEB-INF/pages/system/company/list.jsp`页面代码【不用编写】

<img src="assets/image-20230601163241215.png" alt="image-20230601163241215" style="zoom:50%;" />

<img src="assets/image-20230601163347421.png" alt="image-20230601163347421" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230601163435159.png" alt="image-20230601163435159" style="zoom:50%;" />

#### 5.2 后端代码实现

<img src="assets/image-20230602090740966.png" alt="image-20230602090740966" style="zoom:50%;" />

##### 5.2.1 控制层

- CompanyServlet类

```java
/**
     * 处理删除数据的方法
     * @param request
     * @param response
     */
private void delete(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数id，
    String id = request.getParameter("id");
    //2 调用service层方法，删除数据
    companyService.delete(id);
    //3 页面跳转
    list(request,response);
}
```

##### 5.2.2 业务层

- CompanyService接口

```java
/**
   * 删除信息
   * @param id
   */
void delete(String id) throws SQLException;
```

- CompanyServiceImpl实现类

```java
/**
     * 删除信息
     * @param id
     */
@Override
public void delete(String id) throws SQLException {
    companyDao.delete(id);
}
```

##### 5.2.3 数据访问层

- CompanyDao接口

```java
/**
     * 删除数据
     * @param id 要删除数据的id
     */
void delete(String id) throws SQLException;
```

- CompanyDaoImpl实现类

```java
/**
     * 删除数据
     * @param id 要删除数据的id
     */
@Override
public void delete(String id) throws SQLException {
    queryRunner.update("delete from company where id=?",id);
}
```

### 6、抽取BaseServlet

- 抽取BaseServlet

```java
//需求：将判断标记的代码抽取到这个父类中，以后我们写的所有Servlet都继承这个父类，不用在判断标记
public class BaseServlet extends HttpServlet {

    /**
     * 只要服务器发送请求，service方法都会执行，能够处理GET请求和POST请求。
     *
     * 实现步骤：
     *      1、获取标记
     *      2、根据标记找到子类对象的方法
     *      3、执行之类对象的方法
     *
     * @param request
     * @param response
     * @throws ServletException
     * @throws IOException
     */
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //1、获取标记
        String operation = request.getParameter("operation"); //list、toAdd、save......
        //2、根据标记找到子类对象的方法，获取class对象的第二种方式：对象.getClass()
        //System.out.println(this); // BaseServlet对象还是子类对象？--->结果：是子类对象
        Class<? extends BaseServlet> clazz = this.getClass();
        //clazz.getMethod(); //只能获取public修饰的方法
        try {
            //参数1：要找的方法名。参数2和参数3：要找的方法的参数类型
            Method method = clazz.getDeclaredMethod(operation, HttpServletRequest.class, HttpServletResponse.class);//只可以获取任意方法，包括非public修饰的方法

            //由于方法是非public修饰的，没有权限执行，所以在执行之前需要开启访问权限
            method.setAccessible(true);

            //3、执行之类对象的方法
            //参数1：表示要执行哪个对象身上的方法。参数2和参数3：执行子类对象方法要传递的参数值
            method.invoke(this,request,response);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

- 我们的CompanyServlet、DeptServlet等都继承BaseServlet，不需要重新doGet或者doPost方法判断标记

```java
@WebServlet("/system/dept")
public class DeptServlet extends BaseServlet {
    
}
```



## 四、部门管理

### 1、需求分析

![image-20230601174709684](assets/image-20230601174709684.png)

​		点击“==平台系统管理-->部门管理==”，首先需要==分页查询==所有部门信息，其次点击“==新建==”会弹出对话框，添加部门信息。点击每个条目后面的“==编辑==”按钮弹出对话框，会==根据id查询部门信息==显示在对话框中，用户可以针对部门信息进行修改，修改完成之后点击对话框中的“==保存”完成修改==操作。最后就是点击条目后面的“==删除==”按钮，可以根据id删除一个部门信息。

对应的表结构如下：

<img src="assets/image-20230602100814311.png" alt="image-20230602100814311" style="zoom:50%;" />

### 2、分页查询

![image-20230601181819651](assets/image-20230601181819651.png)

> 注意：此列表中有一列数据叫做“==所属部门==”，它代表每个部门的父部门。例如：顺义校区属于集团总部的，在表中“顺义校区”的parentId对应集团总部的id。也就是根据上图==表结构==中foreign key来对应的。因此在查询每个部门的时候还需要根据parentId来查询它的父部门

#### 2.1 前端代码实现

- 点击侧边栏“==部门管理==”发送请求代码`pages/home/aside.jsp`【不用编写】

<img src="assets/image-20230601181611034.png" alt="image-20230601181611034" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230601181705154.png" alt="image-20230601181705154" style="zoom:50%;" />

<img src="assets/image-20230601181727682.png" alt="image-20230601181727682" style="zoom:50%;" />

<img src="assets/image-20230601181705154.png" alt="image-20230601181705154" style="zoom:50%;" /><img src="assets/image-20230601181727682.png" alt="image-20230601181727682" style="zoom:50%;" />

#### 2.2 后端代码实现

##### 2.2.1 控制层

- DeptServlet类

> 说明：由于我们之前抽取了一个BaseServlet类，后期我们的Servlet都继承BaseServlet即可，直接定义和operation同名的方法来处理对应的请求。

```java
@WebServlet("/system/dept")
public class DeptServlet extends BaseServlet {

    private DeptService deptService=new DeptServiceImpl();

    /**
     * 处理分页查询的请求
     * @param request
     * @param response
     */
    private void list(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
        //1 获取请求参数（当前页数和每页条数）
        String _currPage = request.getParameter("currPage");
        //判断非空
        int currPage=1,pageSize=5; //定义默认的页码和每页条数
        if(!StringUtils.isBlank(_currPage)){
            currPage=Integer.parseInt(_currPage);
        }
        //2 调用service层方法获取分页结果
        PageBean<Dept> pageBean = deptService.findPage(currPage, pageSize);

        //3 将结果存储到request域中，跳转到list.jsp页面
        request.setAttribute("page",pageBean);
        request.getRequestDispatcher("/WEB-INF/pages/system/dept/list.jsp").forward(request,response);
    }
}
```

##### 2.2.2 业务层

- DeptService接口

```java
/**
     * 分页查询查询信息
     * @return
     */
PageBean<Dept> findPage(int currPage, int pageSize) throws SQLException;
```

- DeptServiceImpl实现类

```java
/**
     * 分页查询查询信息
     * @return
     */
@Override
public PageBean<Dept> findPage(int currPage, int pageSize) throws SQLException {
    //1 查询总记录数
    long total=deptDao.findTotal();
    //2 计算起始索引
    int start=(currPage-1)*pageSize;
    //3 查询当前页数据
    List<Dept> list=deptDao.findPage(start,pageSize);
    //4 遍历list集合,查询每个部门的所属部门(父部门)
    for (Dept dept : list) {
        Dept parent = deptDao.findById(dept.getParentId());
        dept.setParent(parent);
    }
    //5 封装分页结果并返回
    return new PageBean<>(currPage,pageSize,total,list);
}
```

##### 2.2.3 数据访问层

- DeptDao接口

```java
/**
     * 查询总记录数
     * @return
     */
long findTotal() throws SQLException;
/**
     * 查询当前页数据
     * @param start 当前页起始索引
     * @param pageSize 每页条数
     * @return 当前页数据
     */
List<Dept> findPage(int start, int pageSize) throws SQLException;

/**
     * 根据id查询数据
     * @param id 要查询数据的id
     * @return 返回的是查询结果的对象
     */
Dept findById(String id) throws SQLException;
```

- DeptDaoImpl实现类

```java
/**
     * 查询总记录数
     * @return
     */
@Override
public long findTotal() throws SQLException {
    return queryRunner.query("select count(*) from dept",new ScalarHandler<>());
}
/**
     * 查询当前页数据
     * @param start 当前页起始索引
     * @param pageSize 每页条数
     * @return 当前页数据
     */
@Override
public List<Dept> findPage(int start, int pageSize) throws SQLException {
    return queryRunner.query("select * from dept order by updateTime desc limit ?,?",new BeanListHandler<>(Dept.class),start,pageSize);
}

/**
     * 根据id查询数据
     * @param id 要查询数据的id
     * @return 返回的是查询结果的对象
     */
@Override
public Dept findById(String id) throws SQLException {
    return queryRunner.query("select * from dept where id=?",new BeanHandler<>(Dept.class),id);
}
```

### 3、新增部门

![image-20230601182608429](assets/image-20230601182608429.png)

> 分析：此功能分两部分做，分别是==跳转到“新增部门”页面==，再点击“保存”按钮==保存部门信息==。在跳转到“新增部门”页面之前需要查询所有部门信息，保存到域对象中跳转到“新增部门”页面展示

#### 3.1 前端代码实现

- `/WEB-INF/pages/system/dept/list.jsp`页面代码【不用编写】

<img src="assets/image-20230601183235906.png" alt="image-20230601183235906" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230601183418513.png" alt="image-20230601183418513" style="zoom:50%;" />

- `/WEB-INF/pages/system/dept/add.jsp`页面代码【不用编写】

![image-20230601183330402](assets/image-20230601183330402.png)

- F12抓包数据

<img src="assets/image-20230601183506526.png" alt="image-20230601183506526" style="zoom:50%;" />

<img src="assets/image-20230601183530091.png" alt="image-20230601183530091" style="zoom:50%;" />

#### 3.2 后端代码实现

##### 3.2.1 控制层

- DeptServlet类

```java
/**
     * 处理跳转到添加页面的请求
     * @param request
     * @param response
     */
private void toAdd(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //查询所有部门,保存到域对象中
    List<Dept> list=deptService.findAll();
    request.setAttribute("deptList",list);
    //只能使用请求转发，因为页面是在web-inf中，浏览器不能直接通过路径访问
    request.getRequestDispatcher("/WEB-INF/pages/system/dept/add.jsp").forward(request,response);
}

/**
     * 处理添加数据的请求
     * @param request
     * @param response
     */
private void save(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数并封装成Dept对象
    Dept dept = BeanUtil.fillBean(request, Dept.class);
    //2 调用service层方法添加数据
    deptService.save(dept);
    //3 页面跳转
    list(request,response);
}
```

##### 3.2.2 业务层

- DeptService接口

```java
/**
   * 查询所有部门
   * @return
   */
List<Dept> findAll() throws SQLException;
/**
     * 保存信息
     * @param dept
     */
void save(Dept dept) throws SQLException;
```

- DeptServiceImpl实现类

```java
/**
     * 查询所有部门
     * @return
     */
@Override
public List<Dept> findAll() throws SQLException {
    return deptDao.findAll();
}

/**
     * 保存信息
     * @param dept
     */
@Override
public void save(Dept dept) throws SQLException {
    //1 生成唯一id，设置给dept
    String id = UUID.randomUUID().toString();
    dept.setId(id);
    //2 调用dao层方法
    deptDao.save(dept);
}
```

##### 3.2.3 数据访问层

- DeptDao接口

```java
/**
     * 查询所有部门
     * @return
     */
List<Dept> findAll() throws SQLException;    
/**
     * 添加数据
     * @param dept 要添加的对象
     */
void save(Dept dept) throws SQLException;
```

- DeptDaoImpl实现类

```java
/**
     * 查询所有部门
     * @return
     */
@Override
public List<Dept> findAll() throws SQLException {
    return queryRunner.query("select * from dept order by updateTime desc",new BeanListHandler<>(Dept.class));
}

/**
     * 添加数据
     * @param dept 要添加的对象
     */
@Override
public void save(Dept dept) throws SQLException {
    queryRunner.update("insert into dept values(?,?,?,?,now(),now())",dept.getId(),dept.getName(),dept.getParentId(),dept.getState());
}
```

### 4、编辑部门

<img src="assets/image-20230601183945886.png" alt="image-20230601183945886" style="zoom:50%;" />

<img src="assets/image-20230601184014099.png" alt="image-20230601184014099" style="zoom:50%;" />

> 分析：此功能分两部分做，分别是跳转到“编辑部门”页面回显部门信息，再点击“保存”按钮修改存部门信息，在跳转到“编辑部门”页面之前需要==查询当前部门==和==所有部门信息==，保存到域对象中跳转到“编辑部门”页面展示

#### 4.1 前端代码实现

- `/WEB-INF/pages/system/dept/list.jsp`页面代码【不用编写】

<img src="assets/image-20230601184225436.png" alt="image-20230601184225436" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230601184307702.png" alt="image-20230601184307702" style="zoom:50%;" />

- `/WEB-INF/pages/system/dept/update.jsp`页面代码【不用编写】

<img src="assets/image-20230601184512125.png" alt="image-20230601184512125" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230601184349416.png" alt="image-20230601184349416" style="zoom:50%;" />

<img src="assets/image-20230601184416948.png" alt="image-20230601184416948" style="zoom:50%;" />

#### 4.2 后端代码实现

##### 4.2.1 控制层

- DeptServlet类

```java
/**
     * 处理跳转到修改页面的氢气
     * @param request
     * @param response
     */
private void toEdit(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取要修改的数据id
    String id = request.getParameter("id");
    //2 调用service层方法，根据id查询数据,保存到域对象中
    Dept dept = deptService.findById(id);
    request.setAttribute("dept",dept);
    //3 查询所有部门,保存到域对象中
    List<Dept> list=deptService.findAll();
    request.setAttribute("deptList",list);
    //只能使用请求转发，因为页面是在web-inf中，浏览器不能直接通过路径访问
    request.getRequestDispatcher("/WEB-INF/pages/system/dept/update.jsp").forward(request,response);
}

/**
     * 处理修改数据的请求
     * @param request
     * @param response
     */
private void edit(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数并封装
    Dept dept = BeanUtil.fillBean(request, Dept.class);
    //2 调用service层方法，修改数据
    deptService.update(dept);
    //3 页面跳转
    list(request,response);
}
```

##### 4.2.2 业务层

- DeptService接口

```java
/**
     * 根据id查询信息
     * @param id 要查询的id
     * @return 返回对象
     */
Dept findById(String id) throws SQLException;
/**
     * 修改信息
     * @param dept
     */
void update(Dept dept) throws SQLException;
```

- DeptServiceImpl实现类

```java
/**
     * 根据id查询信息
     * @param id 要查询的id
     * @return 返回对象
     */
@Override
public Dept findById(String id) throws SQLException {
    return deptDao.findById(id);
}
/**
     * 修改信息
     * @param dept
     */
@Override
public void update(Dept dept) throws SQLException {
    deptDao.update(dept);
}
```

##### 4.2.3 数据访问层

- DeptDao接口

```java
/**
     * 根据id查询数据
     * @param id 要查询数据的id
     * @return 返回的是查询结果的对象
     */
Dept findById(String id) throws SQLException;
/**
     * 修改数据
     * @param dept 要修改的对象
     */
void update(Dept dept) throws SQLException;
```

- DeptDaoImpl实现类

```java
/**
     * 根据id查询数据
     * @param id 要查询数据的id
     * @return 返回的是查询结果的对象
     */
@Override
public Dept findById(String id) throws SQLException {
    return queryRunner.query("select * from dept where id=?",new BeanHandler<>(Dept.class),id);
}

/**
     * 修改数据
     * @param dept 要修改的对象
     */
@Override
public void update(Dept dept) throws SQLException {
    queryRunner.update("update dept set name=?,parentId=?,state=?,updateTime=now() where id=?",dept.getName(),dept.getParentId(),dept.getState(),dept.getId());
}
```

### 5、删除部门

#### 5.1 前端代码实现

- `/WEB-INF/pages/system/dept/list.jsp`页面代码【不用编写】

<img src="assets/image-20230601185323474.png" alt="image-20230601185323474" style="zoom:50%;" />

<img src="assets/image-20230601185411259.png" alt="image-20230601185411259" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230601185544538.png" alt="image-20230601185544538" style="zoom:50%;" />

#### 5.2 后端代码实现

##### 5.2.1 控制层

- DeptServlet类

```java
/**
     * 处理删除数据的方法
     * @param request
     * @param response
     */
private void delete(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数id，
    String id = request.getParameter("id");
    //2 调用service层方法，删除数据
    deptService.delete(id);
    //3 页面跳转
    list(request,response);
}
```

##### 5.2.2 业务层

- DeptService接口

```java
/**
   * 删除信息
   * @param id
   */
void delete(String id) throws SQLException;
```

- DeptServiceImpl实现类

```java
/**
     * 删除信息
     * @param id
     */
@Override
public void delete(String id) throws SQLException {
    deptDao.delete(id);
}
```

##### 5.2.3 数据访问层

- DeptDao接口

```java
/**
     * 删除数据
     * @param id 要删除数据的id
     */
void delete(String id) throws SQLException;
```

- DeptDaoImpl实现类

```java
/**
     * 删除数据
     * @param id 要删除数据的id
     */
@Override
public void delete(String id) throws SQLException {
    queryRunner.update("delete from dept where id=?",id);
}
```

## 五、员工管理

### 1、需求分析

![image-20230602100246957](assets/image-20230602100246957.png)

​		点击“==平台系统管理-->员工管理==”，首先需要==分页查询==所有员工信息，其次点击“==新建==”会弹出对话框，添加员工信息。点击每个条目后面的“==编辑==”按钮弹出对话框，会==根据id查询员工信息==显示在对话框中，用户可以针对员工信息进行修改，修改完成之后点击对话框中的“==保存”完成修改==操作。最后就是点击条目后面的“==删除==”按钮，可以根据id删除一个员工信息。

对应的表结构如下：

<img src="assets/image-20230602100642476.png" alt="image-20230602100642476" style="zoom:50%;" />

### 2、分页查询

<img src="assets/image-20230602105437265.png" alt="image-20230602105437265" style="zoom:50%;" />

#### 2.1 前端代码实现

- 点击侧边栏“==员工管理==”发送请求代码`pages/home/aside.jsp`【不用编写】

<img src="assets/image-20230602101025157.png" alt="image-20230602101025157" style="zoom:50%;" />![image-20230602102133502](assets/image-20230602102133502.png)

- F12抓包数据

<img src="assets/image-20230602101053317.png" alt="image-20230602101053317" style="zoom:50%;" />

#### 2.2 后端代码实现

##### 2.2.1 控制层

- UserServlet类

```java
/**
     * 处理分页查询的请求
     * @param request
     * @param response
     */
private void list(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数（当前页数和每页条数）
    String _currPage = request.getParameter("currPage");
    //判断非空
    int currPage=1,pageSize=5; //定义默认的页码和每页条数
    if(!StringUtils.isBlank(_currPage)){
        currPage=Integer.parseInt(_currPage);
    }
    //2 调用service层方法获取分页结果
    PageBean<User> pageBean = userService.findPage(currPage, pageSize);

    //3 将结果存储到request域中，跳转到list.jsp页面
    request.setAttribute("page",pageBean);
    request.getRequestDispatcher("/WEB-INF/pages/system/user/list.jsp").forward(request,response);
}
```

##### 2.2.2 业务层

- UserService接口

```java
/**
     * 分页查询查询信息
     * @return
     */
PageBean<User> findPage(int currPage, int pageSize) throws SQLException;
```

- UserServiceImpl实现类

```java
/**
     * 分页查询查询信息
     * @return
     */
@Override
public PageBean<User> findPage(int currPage, int pageSize) throws SQLException {
    //1 查询总记录数
    long total=userDao.findTotal();
    //2 计算起始索引
    int start=(currPage-1)*pageSize;
    //3 查询当前页数据
    List<User> list=userDao.findPage(start,pageSize);
    //遍历集合，查询每个部门的所属部门
    for (User user : list) {
        Dept dept = deptDao.findById(user.getDeptId());
        user.setDept(dept);
    }
    //4 封装分页结果并返回
    return new PageBean<>(currPage,pageSize,total,list);
}
```

> 说明：查询员工的同时要查询这个员工的所属部门，代码为`deptDao.findById(user.getDeptId());` 方法之前做部门管理的时候写过，此处就不用重新写了。

##### 2.2.3 数据访问层

- UserDao接口

```java
/**
     * 查询总记录数
     * @return
     */
long findTotal() throws SQLException;

/**
     * 查询当前页数据
     * @param start 当前页起始索引
     * @param pageSize 每页条数
     * @return 当前页数据
     */
List<User> findPage(int start, int pageSize) throws SQLException;
```

- UserDaoImpl实现类

```java
/**
     * 查询总记录数
     * @return
     */
@Override
public long findTotal() throws SQLException {
    return queryRunner.query("select count(*) from user",new ScalarHandler<>());
}

/**
     * 查询当前页数据
     * @param start 当前页起始索引
     * @param pageSize 每页条数
     * @return 当前页数据
     */
@Override
public List<User> findPage(int start, int pageSize) throws SQLException {
    return queryRunner.query("select * from user order by updateTime desc limit ?,?",new BeanListHandler<>(User.class),start,pageSize);
}
```

### 3、新增员工

<img src="assets/image-20230602104337194.png" alt="image-20230602104337194" style="zoom:50%;" />

![image-20230602104448071](assets/image-20230602104448071.png)

> 说明：此功能分两部分做，分别是跳转到“新增员工”页面，再点击“保存”按钮保存员工信息

#### 3.1 前端代码实现

- `/WEB-INF/pages/system/user/list.jsp`页面代码【不用编写】

<img src="assets/image-20230602102013692.png" alt="image-20230602102013692" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230602102133502.png" alt="image-20230602102133502" style="zoom:50%;" />

- `/WEB-INF/pages/system/user/add.jsp`页面代码【不用编写】

<img src="assets/image-20230602102411237.png" alt="image-20230602102411237" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230602102248063.png" alt="image-20230602102248063" style="zoom:50%;" />

<img src="assets/image-20230602102324613.png" alt="image-20230602102324613" style="zoom:50%;" />

#### 3.2 后端代码实现

##### 3.2.1 控制层

- UserServlet类

```java
/**
     * 处理跳转到添加页面的请求
     * @param request
     * @param response
     */
private void toAdd(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //查询所有部门,保存到域对象中
    List<Dept> list=deptService.findAll();
    request.setAttribute("deptList",list);
    //只能使用请求转发，因为页面是在web-inf中，浏览器不能直接通过路径访问
    request.getRequestDispatcher("/WEB-INF/pages/system/user/add.jsp").forward(request,response);
}

/**
     * 处理添加数据的请求
     * @param request
     * @param response
     */
private void save(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数并封装成User对象
    User user = BeanUtil.fillBean(request, User.class);
    //2 调用service层方法添加数据
    userService.save(user);
    //3 页面跳转
    list(request,response);
}
```

> 说明：toAdd方法中需要查询所有部门信息，此处调用`List<Dept> list=deptService.findAll()`之前做部门管理已经写过了。

##### 3.2.2 业务层

- UserService接口

```java
/**
     * 保存信息
     * @param user
     */
void save(User user) throws SQLException;
```

- UserServiceImpl实现类

```java
/**
     * 保存信息
     * @param user
     */
@Override
public void save(User user) throws SQLException {
    //1 生成唯一id，设置给user
    String id = UUID.randomUUID().toString();
    user.setId(id);
    //给密码进行加密处理
    String password = MD5Util.md5(user.getPassword());
    user.setPassword(password);
    //2 调用dao层方法
    userDao.save(user);
}
```

> 注意：我们保存到表中的密码要进行加密，此处使用的是MD5加密算法，使用` MD5Util.md5(user.getPassword())`即可实现。

##### 3.2.3 数据访问层

- UserDao接口

```java
/**
     * 添加数据
     * @param user 要添加的对象
     */
void save(User user) throws SQLException;
```

- UserDaoImpl实现类

```java
/**
     * 添加数据
     * @param user 要添加的对象
     */
@Override
public void save(User user) throws SQLException {
    queryRunner.update("insert into user values(?,?,?,?,?,?,?,?,?,?,now(),now())",user.getId(),user.getEmail(),user.getUsername(),user.getPassword(),user.getState(),user.getGender(),user.getTelephone(),user.getBirthday(),user.getJoinDate(),user.getDeptId());
}
```

### 4、编辑员工

<img src="assets/image-20230602105044381.png" alt="image-20230602105044381" style="zoom:50%;" />

<img src="assets/image-20230602105110778.png" alt="image-20230602105110778" style="zoom:50%;" />

> 说明：此功能分两部分做，分别是跳转到“编辑员工”页面回显员工信息，再点击“保存”按钮修改员工信息

#### 4.1 前端代码实现

- `/WEB-INF/pages/system/user/list.jsp`页面代码【不用编写】

<img src="assets/image-20230602103628849.png" alt="image-20230602103628849" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230602103703231.png" alt="image-20230602103703231" style="zoom:50%;" />

- `/WEB-INF/pages/system/user/update.jsp`页面代码【不用编写】

<img src="assets/image-20230602103810044.png" alt="image-20230602103810044" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230602103856176.png" alt="image-20230602103856176" style="zoom:50%;" />

<img src="assets/image-20230602103921662.png" alt="image-20230602103921662" style="zoom:50%;" />

#### 4.2 后端代码实现

##### 4.2.1 控制层

- UserServlet类

```java
/**
     * 处理跳转到修改页面的氢气
     * @param request
     * @param response
     */
private void toEdit(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取要修改的数据id
    String id = request.getParameter("id");
    // 2 调用service层方法，根据id查询数据,保存到request域中
    User user = userService.findById(id);
    request.setAttribute("user",user);

    //查询所有部门,保存到域对象中
    List<Dept> list=deptService.findAll();
    request.setAttribute("deptList",list);

    //只能使用请求转发，因为页面是在web-inf中，浏览器不能直接通过路径访问
    request.getRequestDispatcher("/WEB-INF/pages/system/user/update.jsp").forward(request,response);
}

/**
     * 处理修改数据的请求
     * @param request
     * @param response
     */
private void edit(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数并封装
    User user = BeanUtil.fillBean(request, User.class);
    //2 调用service层方法，修改数据
    userService.update(user);
    //3 页面跳转
    list(request,response);
}
```

> toEdit()方法中需要根据id查询员工和查询所有部门信息。

##### 4.2.2 业务层

- UserService接口

```java
/**
   * 根据id查询信息
   * @param id 要查询的id
   * @return 返回对象
   */
User findById(String id) throws SQLException;
/**
     * 修改信息
     * @param user
     */
void update(User user) throws SQLException;
```

- UserServiceImpl实现类

```java
/**
     * 根据id查询信息
     * @param id 要查询的id
     * @return 返回对象
     */
@Override
public User findById(String id) throws SQLException {
    return userDao.findById(id);
}	
/**
     * 修改信息
     * @param user
     */
@Override
public void update(User user) throws SQLException {
    userDao.update(user);
}
```

##### 4.2.3 数据访问层

- UserDao接口

```java
/**
     * 根据id查询数据
     * @param id 要查询数据的id
     * @return 返回的是查询结果的对象
     */
User findById(String id) throws SQLException;
/**
     * 修改数据
     * @param user 要修改的对象
     */
void update(User user) throws SQLException;
```

- UserDaoImpl实现类

```java
/**
     * 根据id查询数据
     * @param id 要查询数据的id
     * @return 返回的是查询结果的对象
     */
@Override
public User findById(String id) throws SQLException {
    return queryRunner.query("select * from user where id=?",new BeanHandler<>(User.class),id);
}

/**
     * 修改数据
     * @param user 要修改的对象
     */
@Override
public void update(User user) throws SQLException {
    queryRunner.update("update user set email=?,username=?,password=?,state=?,gender=?,telephone=?,birthday=?,joinDate=?,deptId=?,updateTime=now() where id=?",user.getEmail(),user.getUsername(),user.getPassword(),user.getState(),user.getGender(),user.getTelephone(),user.getBirthday(),user.getJoinDate(),user.getDeptId(),user.getId());
}
```

### 5、删除员工

<img src="assets/image-20230602105143886.png" alt="image-20230602105143886" style="zoom:50%;" />

#### 5.1 前端代码实现

- `/WEB-INF/pages/system/user/list.jsp`页面代码【不用编写】

<img src="assets/image-20230602150037606.png" alt="image-20230602150037606" style="zoom:50%;" />

<img src="assets/image-20230602150106105.png" alt="image-20230602150106105" style="zoom:50%;" />

- F12抓包数据

<img src="assets/image-20230602105252314.png" alt="image-20230602105252314" style="zoom:50%;" />

#### 5.2 后端代码实现

##### 5.2.1 控制层

- UserServlet类

```java
/**
     * 处理删除数据的方法
     * @param request
     * @param response
     */
private void delete(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException, SQLException {
    //1 获取请求参数id，
    String id = request.getParameter("id");
    //2 调用service层方法，删除数据
    userService.delete(id);
    //3 页面跳转
    list(request,response);
}
```

##### 5.2.2 业务层

- UserService接口

```java
  /**
   * 删除信息
   * @param id
   */
  void delete(String id) throws SQLException;
```

- UserServiceImpl实现类

```java
/**
     * 删除信息
     * @param id
     */
@Override
public void delete(String id) throws SQLException {
    userDao.delete(id);
}
```

##### 5.2.3 数据访问层

- UserDao接口

```java
/**
     * 删除数据
     * @param id 要删除数据的id
     */
void delete(String id) throws SQLException;
```

- UserDaoImpl实现类

```java
/**
     * 删除数据
     * @param id 要删除数据的id
     */
@Override
public void delete(String id) throws SQLException {
    queryRunner.update("delete from user where id=?",id);
}
```

## 六、角色管理【实战】

### 1、需求分析

<img src="assets/image-20230602105521179.png" alt="image-20230602105521179" style="zoom:50%;" />

​		点击“==平台系统管理-->角色管理==”，首先需要==分页查询==所有角色信息，其次点击“==新建==”会弹出对话框，添加角色信息。点击每个条目后面的“==编辑==”按钮弹出对话框，会==根据id查询角色信息==显示在对话框中，用户可以针对角色信息进行修改，修改完成之后点击对话框中的“==保存”完成修改==操作。最后就是点击条目后面的“==删除==”按钮，可以根据id删除一个角色信息。

对应的表结构如下：

<img src="assets/image-20230602105840042.png" alt="image-20230602105840042" style="zoom:50%;" />

### 2、分页查询

#### 2.1 前端代码实现

- 点击侧边栏“==角色管理==”发送请求代码`pages/home/aside.jsp`【不用编写】



- F12抓包数据



#### 2.2 后端代码实现

##### 2.2.1 控制层

- RoleServlet类

```java

```

##### 2.2.2 业务层

- RoleService接口

```java

```

- RoleServiceImpl实现类

```java

```

##### 2.2.3 数据访问层

- RoleDao接口

```java

```

- RoleDaoImpl实现类

```java

```

### 3、新增角色

> 说明：此功能分两部分做，分别是跳转到“新增角色”页面，再点击“保存”按钮保存角色信息

#### 3.1 前端代码实现

- `/WEB-INF/pages/system/role/list.jsp`页面代码【不用编写】



- F12抓包数据



- `/WEB-INF/pages/system/role/add.jsp`页面代码【不用编写】



- F12抓包数据



#### 3.2 后端代码实现

##### 3.2.1 控制层

- RoleServlet类

```java

```

##### 3.2.2 业务层

- RoleService接口

```java

```

- RoleServiceImpl实现类

```java

```

##### 3.2.3 数据访问层

- RoleDao接口

```java

```

- RoleDaoImpl实现类

```java

```

### 4、编辑角色

> 说明：此功能分两部分做，分别是跳转到“编辑角色”页面回显角色信息，再点击“保存”按钮修改角色信息

#### 4.1 前端代码实现

- `/WEB-INF/pages/system/role/list.jsp`页面代码【不用编写】



- F12抓包数据



- `/WEB-INF/pages/system/role/update.jsp`页面代码【不用编写】



- F12抓包数据



#### 4.2 后端代码实现

##### 4.2.1 控制层

- RoleServlet类

```java

```

##### 4.2.2 业务层

- RoleService接口

```java

```

- RoleServiceImpl实现类

```java

```

##### 4.2.3 数据访问层

- RoleDao接口

```java

```

- RoleDaoImpl实现类

```java

```

### 5、删除角色

#### 5.1 前端代码实现

- `/WEB-INF/pages/system/role/list.jsp`页面代码【不用编写】



- F12抓包数据



#### 5.2 后端代码实现

##### 5.2.1 控制层

- RoleServlet类

```java

```

##### 5.2.2 业务层

- RoleService接口

```java

```

- RoleServiceImpl实现类

```java

```

##### 5.2.3 数据访问层

- RoleDao接口

```java

```

- RoleDaoImpl实现类

```java

```

## 七、模块管理【实战】

### 1、需求分析

<img src="assets/image-20230602110301956.png" alt="image-20230602110301956" style="zoom:50%;" />

​		点击“==平台系统管理-->模块管理==”，首先需要==分页查询==所有模块信息，其次点击“==新建==”会弹出对话框，添加模块信息。点击每个条目后面的“==编辑==”按钮弹出对话框，会==根据id查询模块信息==显示在对话框中，用户可以针对模块信息进行修改，修改完成之后点击对话框中的“==保存”完成修改==操作。最后就是点击条目后面的“==删除==”按钮，可以根据id删除一个模块信息。后期我们可以做到不同的用户登录进来之后，展示不同的侧边栏。

对应的表结构如下：

<img src="assets/image-20230602110745884.png" alt="image-20230602110745884" style="zoom:50%;" />

### 2、分页查询

#### 2.1 前端代码实现

- 点击侧边栏“==模块管理==”发送请求代码`pages/home/aside.jsp`【不用编写】



- F12抓包数据



#### 2.2 后端代码实现

##### 2.2.1 控制层

- ModuleServlet类

```java

```

##### 2.2.2 业务层

- ModuleService接口

```java

```

- ModuleServiceImpl实现类

```java

```

##### 2.2.3 数据访问层

- ModuleDao接口

```java

```

- ModuleDaoImpl实现类

```java

```

### 3、新增模块

> 说明：此功能分两部分做，分别是跳转到“新增模块”页面，再点击“保存”按钮保存模块信息

#### 3.1 前端代码实现

- `/WEB-INF/pages/system/module/list.jsp`页面代码【不用编写】



- F12抓包数据



- `/WEB-INF/pages/system/module/add.jsp`页面代码【不用编写】



- F12抓包数据



#### 3.2 后端代码实现

##### 3.2.1 控制层

- ModuleServlet类

```java

```

##### 3.2.2 业务层

- ModuleService接口

```java

```

- ModuleServiceImpl实现类

```java

```

##### 3.2.3 数据访问层

- ModuleDao接口

```java

```

- ModuleDaoImpl实现类

```java

```

### 4、编辑模块

> 说明：此功能分两部分做，分别是跳转到“编辑模块”页面回显模块信息，再点击“保存”按钮修改模块信息

#### 4.1 前端代码实现

- `/WEB-INF/pages/system/module/list.jsp`页面代码【不用编写】



- F12抓包数据



- `/WEB-INF/pages/system/module/update.jsp`页面代码【不用编写】



- F12抓包数据



#### 4.2 后端代码实现

##### 4.2.1 控制层

- ModuleServlet类

```java

```

##### 4.2.2 业务层

- ModuleService接口

```java

```

- ModuleServiceImpl实现类

```java

```

##### 4.2.3 数据访问层

- ModuleDao接口

```java

```

- ModuleDaoImpl实现类

```java

```

### 5、删除模块

#### 5.1 前端代码实现

- `/WEB-INF/pages/system/module/list.jsp`页面代码【不用编写】



- F12抓包数据



#### 5.2 后端代码实现

##### 5.2.1 控制层

- ModuleServlet类

```java

```

##### 5.2.2 业务层

- ModuleService接口

```java

```

- ModuleServiceImpl实现类

```java

```

##### 5.2.3 数据访问层

- ModuleDao接口

```java

```

- ModuleDaoImpl实现类

```java

```

## 八、学科管理【实战】

### 1、需求分析

<img src="assets/image-20230602111152738.png" alt="image-20230602111152738" style="zoom:50%;" />

​		点击“==题库管理-->题目学科管理==”，首先需要==分页查询==所有学科信息，其次点击“==新建==”会弹出对话框，添加学科信息。点击每个条目后面的“==编辑==”按钮弹出对话框，会==根据id查询学科信息==显示在对话框中，用户可以针对学科信息进行修改，修改完成之后点击对话框中的“==保存”完成修改==操作。最后就是点击条目后面的“==删除==”按钮，可以根据id删除一个学科信息。

对应的表结构如下：

<img src="assets/image-20230602111619739.png" alt="image-20230602111619739" style="zoom:50%;" />

### 2、分页查询

#### 2.1 前端代码实现

- 点击侧边栏“==题目学科管理==”发送请求代码`pages/home/aside.jsp`【不用编写】



- F12抓包数据



#### 2.2 后端代码实现

##### 2.2.1 控制层

- CourseServlet类

```java

```

##### 2.2.2 业务层

- CourseService接口

```java

```

- CourseServiceImpl实现类

```java

```

##### 2.2.3 数据访问层

- CourseDao接口

```java

```

- CourseDaoImpl实现类

```java

```

### 3、新增学科

> 说明：此功能分两部分做，分别是跳转到“新增学科”页面，再点击“保存”按钮保存学科信息

#### 3.1 前端代码实现

- `/WEB-INF/pages/store/course/list.jsp`页面代码【不用编写】



- F12抓包数据



- `/WEB-INF/pages/store/course/add.jsp`页面代码【不用编写】



- F12抓包数据



#### 3.2 后端代码实现

##### 3.2.1 控制层

- CourseServlet类

```java

```

##### 3.2.2 业务层

- CourseService接口

```java

```

- CourseServiceImpl实现类

```java

```

##### 3.2.3 数据访问层

- CourseDao接口

```java

```

- CourseDaoImpl实现类

```java

```

### 4、编辑学科

> 说明：此功能分两部分做，分别是跳转到“编辑学科”页面回显学科信息，再点击“保存”按钮修改学科信息

#### 4.1 前端代码实现

- `/WEB-INF/pages/store/course/list.jsp`页面代码【不用编写】



- F12抓包数据



- `/WEB-INF/pages/store/course/update.jsp`页面代码【不用编写】



- F12抓包数据



#### 4.2 后端代码实现

##### 4.2.1 控制层

- CourseServlet类

```java

```

##### 4.2.2 业务层

- CourseService接口

```java

```

- CourseServiceImpl实现类

```java

```

##### 4.2.3 数据访问层

- CourseDao接口

```java

```

- CourseDaoImpl实现类

```java

```

### 5、删除学科

#### 5.1 前端代码实现

- `/WEB-INF/pages/store/course/list.jsp`页面代码【不用编写】



- F12抓包数据



#### 5.2 后端代码实现

##### 5.2.1 控制层

- CourseServlet类

```java

```

##### 5.2.2 业务层

- CourseService接口

```java

```

- CourseServiceImpl实现类

```java

```

##### 5.2.3 数据访问层

- CourseDao接口

```java

```

- CourseDaoImpl实现类

```java

```

## 九、题目类型管理【实战】

### 1、需求分析

<img src="assets/image-20230602112150586.png" alt="image-20230602112150586" style="zoom:50%;" />

​		点击==“题库管理-->题目类型管理==”，首先需要==分页查询==所有题目类型信息，其次点击“==新建==”会弹出对话框，添加题目类型信息。点击每个条目后面的“==编辑==”按钮弹出对话框，会==根据id查询题目类型信息==显示在对话框中，用户可以针对题目类型信息进行修改，修改完成之后点击对话框中的“==保存”完成修改==操作。最后就是点击条目后面的“==删除==”按钮，可以根据id删除一个题目类型信息。

对应的表结构如下：

<img src="assets/image-20230602112338380.png" alt="image-20230602112338380" style="zoom:50%;" />

### 2、分页查询

#### 2.1 前端代码实现

- 点击侧边栏“==题目类型管理==”发送请求代码`pages/home/aside.jsp`【不用编写】



- F12抓包数据



#### 2.2 后端代码实现

##### 2.2.1 控制层

- CatalogServlet类

```java

```

##### 2.2.2 业务层

- CatalogService接口

```java

```

- CatalogServiceImpl实现类

```java

```

##### 2.2.3 数据访问层

- CatalogDao接口

```java

```

- CatalogDaoImpl实现类

```java

```

### 3、新增题目类型

> 说明：此功能分两部分做，分别是跳转到“新增题目类型”页面，再点击“保存”按钮保存题目类型信息

#### 3.1 前端代码实现

- `/WEB-INF/pages/store/catalog/list.jsp`页面代码【不用编写】



- F12抓包数据



- `/WEB-INF/pages/store/catalog/add.jsp`页面代码【不用编写】



- F12抓包数据



#### 3.2 后端代码实现

##### 3.2.1 控制层

- CatalogServlet类

```java

```

##### 3.2.2 业务层

- CatalogService接口

```java

```

- CatalogServiceImpl实现类

```java

```

##### 3.2.3 数据访问层

- CatalogDao接口

```java

```

- CatalogDaoImpl实现类

```java

```

### 4、编辑题目类型

> 说明：此功能分两部分做，分别是跳转到“编辑题目类型”页面回显题目类型信息，再点击“保存”按钮修改题目类型信息

#### 4.1 前端代码实现

- `/WEB-INF/pages/store/catalog/list.jsp`页面代码【不用编写】



- F12抓包数据



- `/WEB-INF/pages/store/catalog/update.jsp`页面代码【不用编写】



- F12抓包数据



#### 4.2 后端代码实现

##### 4.2.1 控制层

- CatalogServlet类

```java

```

##### 4.2.2 业务层

- CatalogService接口

```java

```

- CatalogServiceImpl实现类

```java

```

##### 4.2.3 数据访问层

- CatalogDao接口

```java

```

- CatalogDaoImpl实现类

```java

```

### 5、删除题目类型

#### 5.1 前端代码实现

- `/WEB-INF/pages/store/catalog/list.jsp`页面代码【不用编写】



- F12抓包数据



#### 5.2 后端代码实现

##### 5.2.1 控制层

- CatalogServlet类

```java

```

##### 5.2.2 业务层

- CatalogService接口

```java

```

- CatalogServiceImpl实现类

```java

```

##### 5.2.3 数据访问层

- CatalogDao接口

```java

```

- CatalogDaoImpl实现类

```java

```



